#!/bin/bash

# Installing the packages
add-apt-repository ppa:mrazavi/openvas
apt-get update
apt-get install openvas9

# Updating OpenVAS
greenbone-nvt-sync
greenbone-scapdata-sync
greenbone-certdata-sync
service openvas-scanner restart
service openvas-manager restart
openvasmd --rebuild --progress

# Downloading cve-search 
cd /opt/
git clone https://github.com/cve-search/cve-search.git 

# Installing Dependencies via pip
cd cve-search; sudo pip3 install -r requirements.txt

# Building MongoDV database and populating
./sbin/db_mgmt_json.py -p
./sbin/db_mgmt_cpe_dictionary.py
./sbin/db_updater.py -c

# Testing cve-search 
./bin/search.py -c CVE-2010-3333 -o json|jq

# Installing Metasploit 
curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall && chmod 755 msfinstall && ./msfinstall

# Testing the tool 
msfconsole
search cve-2014-0160

